<!DOCTYPE html>
<html>

<head>
    <title>Hero Practice Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hero-char {
            display: inline-block;
            padding: 2px 1px;
            transition: all 0.1s ease;
        }

        .hero-char-current {
            background: rgba(99, 102, 241, 0.1);
            border-bottom: 2px solid #6366f1;
        }

        .hero-char-correct {
            color: #10b981;
            font-weight: 500;
        }

        .hero-char-wrong {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
    </style>
</head>

<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto bg-white p-8 rounded-3xl shadow-lg">
        <h2 class="text-2xl font-bold mb-4">Hero Practice Test</h2>

        <!-- Text Display -->
        <div id="hero-text-display" class="text-lg leading-relaxed font-mono text-gray-800 mb-4">
            Loading...
        </div>

        <!-- Input -->
        <input type="text" id="hero-typing-input" placeholder="Start typing..."
            class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-indigo-500 focus:outline-none text-lg font-mono mb-4" />

        <!-- Stats -->
        <div class="grid grid-cols-3 gap-4">
            <div>
                <div class="text-xs text-gray-500">WPM</div>
                <div id="hero-wpm" class="text-2xl font-bold">0</div>
            </div>
            <div>
                <div class="text-xs text-gray-500">Accuracy</div>
                <div id="hero-accuracy" class="text-2xl font-bold">100%</div>
            </div>
            <div>
                <div class="text-xs text-gray-500">Progress</div>
                <div id="hero-progress" class="text-2xl font-bold">0%</div>
            </div>
        </div>
    </div>

    <script>
        console.log('Test page loaded');

        const HeroPractice = (function () {
            let sampleTexts = [
                "The quick brown fox jumps over the lazy dog.",
                "Practice makes perfect when you dedicate time."
            ];

            let current Text = '';
            let startTime = null;

            const el = (id) => document.getElementById(id);

            function init() {
                console.log('HeroPractice.init() called');
                const input = el('hero-typing-input');
                if (!input) {
                    console.error('Input element not found!');
                    return;
                }

                loadNewText();
                input.addEventListener('input', handleInput);
                console.log('Event listeners attached');
            }

            function loadNewText() {
                console.log('loadNewText() called');
                currentText = sampleTexts[0];
                displayText();
            }

            function displayText() {
                const display = el('hero-text-display');
                if (!display) return;
                display.innerHTML = currentText.split('').map((char, idx) =>
                    `<span id="hero-char-${idx}" class="hero-char">${char === ' ' ? '&nbsp;' : char}</span>`
                ).join('');
                console.log('Text displayed:', currentText);
            }

            function handleInput(e) {
                console.log('handleInput called, value:', e.target.value);
                const typed = e.target.value;

                if (!startTime && typed.length === 1) {
                    startTime = Date.now();
                }

                updateDisplay(typed);
                updateStats(typed);
            }

            function updateDisplay(typed) {
                for (let i = 0; i < currentText.length; i++) {
                    const charEl = el(`hero-char-${i}`);
                    if (!charEl) continue;

                    if (i < typed.length) {
                        charEl.className = typed[i] === currentText[i] ? 'hero-char hero-char-correct' : 'hero-char hero-char-wrong';
                    } else {
                        charEl.className = 'hero-char';
                    }
                }
            }

            function updateStats(typed) {
                const timeElapsed = startTime ? (Date.now() - startTime) / 1000 / 60 : 0;
                const wpm = timeElapsed > 0 ? Math.round((typed.length / 5) / timeElapsed) : 0;

                let errors = 0;
                for (let i = 0; i < typed.length; i++) {
                    if (typed[i] !== currentText[i]) errors++;
                }

                const accuracy = typed.length > 0 ? Math.round(((typed.length - errors) / typed.length) * 100) : 100;
                const progress = Math.round((typed.length / currentText.length) * 100);

                el('hero-wpm').textContent = wpm;
                el('hero-accuracy').textContent = accuracy + '%';
                el('hero-progress').textContent = progress + '%';
            }

            return { init };
        })();

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM loaded, initializing...');
            HeroPractice.init();
        });
    </script>
</body>

</html>